<!DOCTYPE HTML>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
	<!-- jQuery first, then Popper.js, then Bootstrap JS -->
	<script type="text/javascript" th:src="@{/webjars/jquery/3.5.1/jquery.min.js/}"></script>
	<script type="text/javascript" th:src="@{/webjars/bootstrap/4.5.0/js/bootstrap.min.js}"></script>
	<script type="text/javascript">
		function getCities(){
			var obj, dbParam, xmlhttp, myObj, x, txt = "";
			dbParam =  document.getElementById("country").value;
			document.getElementById("city").innerHTML = "<option>Loading...</option>";
			xmlhttp = new XMLHttpRequest();
			xmlhttp.onreadystatechange = function() {
			  if (this.readyState == 4 && this.status == 200) {
			    myObj = JSON.parse(this.responseText);
			    document.getElementById("city").innerHTML="";
			    for(x in myObj) {
			    	option = document.createElement('option')
				   	option.text = myObj[x].name;
				   	option.value =  myObj[x].id;
				    document.getElementById("city").add(option);
			    }
			  }
			}
			xmlhttp.open("POST", "/cities", true);
			xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
			xmlhttp.send("country=" + dbParam);
			};
	</script>
</head>
<body>
<th:block th:fragment="header">
    <nav class="navbar navbar-dark bg-dark  navbar-expand-lg">
		<div class="container-fluid">
            <div class="row">
                <a class="navbar-brand" th:href="@{/}">
                    <img th:src="@{/images/computer.png}" alt="logo"/>
                </a>
            </div>
            <div class="container-fluid">
            <a th:href="@{/}">Home</a>
            </div>
            <div class="row">
		    	<form action="#"  th:object="${newCity}" th:acton="@{/city}"  method="post">
					<div class="row">
						<select class="form-control" th:field="*{country}" id="country" onchange="getCities()">
							<option th:each="country : ${countries}" th:value="${country}" th:text="${country}"></option>
						</select>
						
						<select class="form-control" th:field="*{name}" id="city">
						</select>

						<button class="btn btn-primary" type="submit">Submit form</button>
					</div>
		        </form>
		    </div>
   		</div>
    </nav>
</th:block>
</body>
<script th:src="@{/webjars/jquery/jquery-1.12.4.js"></script>
<script th:src="@{/webjars/jquery/ui/1.12.1/jquery-ui.js"></script>
<script th:src="@{/webjars/jquery/jquery.min.js}"></script>
<script th:src="@{/webjars/popper.js/umd/popper.min.js}"></script>
<script th:src="@{/webjars/bootstrap/js/bootstrap.min.js}"></script>
</html>